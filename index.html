<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>For You, Babe</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,300;0,400;0,500;0,600;1,300;1,400&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

:root {
  --bg: #0D0D0D;
  --surface: #161616;
  --surface-2: #1C1C1C;
  --border: #2A2A2A;
  --border-light: #333;
  --amber: #60A5FA;
  --amber-dim: #3B82F6;
  --amber-glow: rgba(96, 165, 250, 0.15);
  --amber-bright: #93C5FD;
  --rose: #E8916D;
  --text: #ffffff;
  --text-dim: #ffffff;
  --text-muted: rgba(255,255,255,0.5);
  --green: #4EC9B0;
  --pink: #D4796B;
}

html { height: 100%; }

body {
  font-family: 'Inter', -apple-system, sans-serif;
  background: var(--bg);
  color: var(--text);
  overflow: hidden;
  height: 100dvh;
  width: 100vw;
  -webkit-font-smoothing: antialiased;
}

/* ── GRID BACKGROUND ── */
.grid-bg {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 0;
  background-image:
    linear-gradient(rgba(96, 165, 250, 0.03) 1px, transparent 1px),
    linear-gradient(90deg, rgba(96, 165, 250, 0.03) 1px, transparent 1px);
  background-size: 40px 40px;
}

/* Warm glow in center */
.glow-bg {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 0;
  background: radial-gradient(ellipse 50% 50% at 50% 50%, rgba(96, 165, 250, 0.06), transparent);
}

/* ── FLOATING HEARTS (subtle) ── */
.hearts-container {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 1;
  overflow: hidden;
}

.floating-heart {
  position: absolute;
  bottom: -40px;
  opacity: 0;
  animation: floatUp linear forwards;
  font-family: 'JetBrains Mono', monospace;
  color: rgba(96, 165, 250, 0.6);
}

@keyframes floatUp {
  0% { opacity: 0; transform: translateY(0) scale(0.8); }
  10% { opacity: 0.15; }
  50% { opacity: 0.08; }
  100% { opacity: 0; transform: translateY(-110vh) scale(1); }
}

/* ── INTRO ── */
.intro-screen {
  position: fixed;
  inset: 0;
  z-index: 100;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  background: var(--bg);
  transition: opacity 0.8s ease, transform 0.8s ease;
}

.intro-screen.hidden {
  opacity: 0;
  transform: scale(1.02);
  pointer-events: none;
}

.intro-tag {
  font-family: 'JetBrains Mono', monospace;
  font-size: 0.7rem;
  color: var(--text-muted);
  letter-spacing: 2px;
  opacity: 0;
  animation: fadeIn 0.8s ease 0.3s forwards;
}

.intro-title {
  font-family: 'Inter', sans-serif;
  font-size: clamp(1.8rem, 7vw, 3.2rem);
  font-weight: 300;
  color: var(--text);
  opacity: 0;
  animation: fadeIn 1s ease 0.6s forwards;
  margin-top: 0.8rem;
  text-align: center;
  padding: 0 1.5rem;
  letter-spacing: -0.5px;
  line-height: 1.3;
}

.intro-title span {
  color: var(--amber);
  font-weight: 500;
}

.intro-subtitle {
  font-family: 'JetBrains Mono', monospace;
  font-size: 0.8rem;
  color: var(--text-dim);
  opacity: 0;
  animation: fadeIn 0.8s ease 1.2s forwards;
  margin-top: 0.8rem;
  font-weight: 300;
}

.intro-enter-btn {
  opacity: 0;
  animation: fadeIn 0.6s ease 1.8s forwards;
  margin-top: 2.5rem;
  padding: 0.75rem 2rem;
  border: 1px solid var(--border-light);
  background: var(--surface);
  color: var(--amber);
  font-family: 'JetBrains Mono', monospace;
  font-size: 0.8rem;
  font-weight: 400;
  letter-spacing: 1px;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.3s ease;
}

.intro-enter-btn:hover {
  background: var(--surface-2);
  border-color: var(--amber-dim);
  box-shadow: 0 0 20px var(--amber-glow);
  transform: translateY(-1px);
}

.intro-enter-btn:active {
  transform: translateY(0);
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

/* ── JAR SCREEN ── */
.jar-screen {
  display: none;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100dvh;
  padding: 1.5rem;
  position: relative;
  z-index: 2;
}

.jar-screen.active {
  display: flex;
  animation: screenIn 0.6s ease;
}

@keyframes screenIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

.jar-header {
  text-align: center;
  margin-bottom: 1.5rem;
}

.jar-header h2 {
  font-family: 'JetBrains Mono', monospace;
  font-size: clamp(1.1rem, 4vw, 1.5rem);
  color: #fff;
  font-weight: 400;
  letter-spacing: 3px;
  text-transform: uppercase;
}

/* ── THE JAR ── */
.jar-wrapper {
  position: relative;
  cursor: pointer;
  -webkit-tap-highlight-color: transparent;
  animation: jarIn 0.8s cubic-bezier(0.22, 1, 0.36, 1) 0.2s both;
}

@keyframes jarIn {
  from { opacity: 0; transform: scale(0.9) translateY(20px); }
  to { opacity: 1; transform: scale(1) translateY(0); }
}

.jar-wrapper:hover .jar { transform: translateY(-3px); }
.jar-wrapper:active .jar { transform: translateY(0) scale(0.98); }

.jar-wrapper.wobble .jar {
  animation: wobble 0.4s ease;
}

@keyframes wobble {
  0% { transform: scale(0.98); }
  25% { transform: scale(1.02) rotate(-1deg); }
  50% { transform: scale(1.01) rotate(0.5deg); }
  100% { transform: scale(1) rotate(0deg); }
}

.jar {
  position: relative;
  width: clamp(180px, 45vw, 250px);
  height: clamp(250px, 62vw, 340px);
  transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
}

/* Jar lid */
.jar-lid {
  position: absolute;
  top: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 62%;
  height: 24px;
  background: linear-gradient(180deg, #4A4540, #3A3530, #2A2520);
  border: 1px solid rgba(255, 255, 255, 0.08);
  border-bottom: none;
  border-radius: 6px 6px 0 0;
  z-index: 3;
  transition: transform 0.3s ease;
}

.jar-wrapper:hover .jar-lid {
  transform: translateX(-50%) translateY(-3px);
}

.jar-lid::after {
  content: '';
  position: absolute;
  bottom: -6px;
  left: -8%;
  width: 116%;
  height: 12px;
  background: linear-gradient(180deg, #353025, #252018);
  border: 1px solid rgba(255, 255, 255, 0.06);
  border-radius: 2px;
}

/* Jar body */
.jar-body {
  position: absolute;
  top: 29px;
  left: 50%;
  transform: translateX(-50%);
  width: 82%;
  height: calc(100% - 29px);
  background: linear-gradient(
    180deg,
    rgba(255, 255, 255, 0.07) 0%,
    rgba(255, 255, 255, 0.03) 40%,
    rgba(96, 165, 250, 0.04) 100%
  );
  border: 1.5px solid rgba(255, 255, 255, 0.1);
  border-radius: 6px 6px 28px 28px;
  overflow: hidden;
  box-shadow:
    0 0 60px rgba(96, 165, 250, 0.08),
    0 20px 50px rgba(0, 0, 0, 0.3),
    inset 0 0 40px rgba(96, 165, 250, 0.03),
    inset 0 1px 0 rgba(255, 255, 255, 0.1);
}

/* Glass shine left */
.jar-body::before {
  content: '';
  position: absolute;
  top: 3%;
  left: 6%;
  width: 18%;
  height: 70%;
  background: linear-gradient(
    185deg,
    rgba(255, 255, 255, 0.12) 0%,
    rgba(255, 255, 255, 0.04) 40%,
    transparent 100%
  );
  border-radius: 40% 30% 30% 40%;
  filter: blur(2px);
}

/* Glass shine right */
.jar-body::after {
  content: '';
  position: absolute;
  top: 10%;
  right: 8%;
  width: 6%;
  height: 30%;
  background: linear-gradient(180deg, rgba(255,255,255,0.08), transparent);
  border-radius: 50%;
  filter: blur(1px);
}

/* Hearts inside */
.jar-notes {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 75%;
  display: flex;
  flex-wrap: wrap;
  align-items: flex-end;
  justify-content: center;
  padding: 8px;
  gap: 2px;
}

.jar-note-mini {
  width: clamp(14px, 3.5vw, 18px);
  height: clamp(13px, 3.2vw, 17px);
  transform: rotate(var(--rot));
  transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
  clip-path: polygon(50% 100%, 0% 38%, 3% 20%, 12% 6%, 25% 0%, 40% 0%, 50% 15%, 60% 0%, 75% 0%, 88% 6%, 97% 20%, 100% 38%);
  opacity: 0.9;
}

.jar-note-mini.removed {
  opacity: 0;
  transform: scale(0) rotate(var(--rot)) translateY(-20px);
}

/* Glow under jar */
.jar-glow {
  position: absolute;
  bottom: -18px;
  left: 50%;
  transform: translateX(-50%);
  width: 80%;
  height: 40px;
  background: radial-gradient(ellipse, rgba(96, 165, 250, 0.25), transparent);
  border-radius: 50%;
  filter: blur(14px);
  animation: glowPulse 3s ease-in-out infinite;
}

@keyframes glowPulse {
  0%, 100% { opacity: 0.6; }
  50% { opacity: 1; }
}

.tap-hint {
  font-family: 'JetBrains Mono', monospace;
  font-size: 0.7rem;
  color: var(--text-muted);
  margin-top: 1.5rem;
  letter-spacing: 1px;
  opacity: 0;
  animation: fadeIn 0.5s ease 0.8s forwards;
}

.blink {
  animation: blink 1s step-end infinite;
}

@keyframes blink {
  0%, 100% { opacity: 1; }
  50% { opacity: 0; }
}

/* ── NOTE OVERLAY ── */
.note-overlay {
  position: fixed;
  inset: 0;
  z-index: 200;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(0, 0, 0, 0);
  backdrop-filter: blur(0px);
  pointer-events: none;
  transition: background 0.4s ease, backdrop-filter 0.4s ease;
}

.note-overlay.active {
  background: rgba(0, 0, 0, 0.6);
  backdrop-filter: blur(12px);
  pointer-events: all;
}

/* 3D flip container */
.note-card {
  max-width: 380px;
  width: 90%;
  height: 260px;
  perspective: 1000px;
  position: relative;
  transform: scale(0.9) translateY(20px);
  transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1), opacity 0.3s ease;
  opacity: 0;
}

.note-overlay.active .note-card {
  transform: scale(1) translateY(0);
  opacity: 1;
}

.note-card-inner {
  position: relative;
  width: 100%;
  height: 100%;
  transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
  transform-style: preserve-3d;
}

.note-card.flipped .note-card-inner {
  transform: rotateY(180deg);
}

.note-front, .note-back {
  position: absolute;
  inset: 0;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  border-radius: 10px;
  border: 1px solid var(--border);
  background: var(--surface);
  box-shadow: 0 25px 60px rgba(0, 0, 0, 0.4), 0 0 40px var(--amber-glow);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  padding: 2rem 1.8rem;
}

/* FRONT — tap to reveal */
.note-front {
  cursor: pointer;
}

.note-front-label {
  font-family: 'JetBrains Mono', monospace;
  font-size: 0.6rem;
  text-transform: uppercase;
  letter-spacing: 3px;
  color: var(--amber-dim);
  margin-bottom: 1rem;
}

.note-front-number {
  font-family: 'JetBrains Mono', monospace;
  font-size: 2.5rem;
  font-weight: 600;
  color: var(--amber);
  line-height: 1;
}

.note-front-hint {
  font-family: 'JetBrains Mono', monospace;
  font-size: 0.65rem;
  color: var(--text-muted);
  margin-top: 1.2rem;
  letter-spacing: 1px;
}

/* BACK — the reason */
.note-back {
  transform: rotateY(180deg);
  position: relative;
}

/* X close */
.note-close-x {
  position: absolute;
  top: 10px;
  right: 10px;
  width: 28px;
  height: 28px;
  border: none;
  background: transparent;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 4px;
  transition: all 0.2s ease;
  z-index: 10;
}

.note-close-x:hover { background: rgba(255,255,255,0.05); }
.note-close-x:active { transform: scale(0.9); }

.note-close-x svg {
  width: 12px;
  height: 12px;
  stroke: var(--text-muted);
  stroke-width: 2;
  stroke-linecap: round;
  transition: stroke 0.2s ease;
}

.note-close-x:hover svg { stroke: var(--text-dim); }

.note-label {
  font-family: 'JetBrains Mono', monospace;
  font-size: 0.6rem;
  text-transform: uppercase;
  letter-spacing: 3px;
  color: var(--amber-dim);
  margin-bottom: 1.2rem;
  font-weight: 400;
}

.note-text {
  font-family: 'Inter', sans-serif;
  font-size: clamp(1.1rem, 4.5vw, 1.4rem);
  font-weight: 300;
  color: var(--text);
  line-height: 1.6;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0.5rem 0;
}

.note-number {
  font-family: 'JetBrains Mono', monospace;
  margin-top: 1.2rem;
  font-size: 0.65rem;
  color: var(--text-muted);
  font-weight: 300;
  letter-spacing: 1px;
}

/* Surprise note */
.note-card.surprise .note-front,
.note-card.surprise .note-back {
  border-color: var(--amber-dim);
  box-shadow: 0 25px 60px rgba(0, 0, 0, 0.5), 0 0 60px var(--amber-glow);
}

.note-card.surprise .note-front-number { color: var(--amber-bright); }
.note-card.surprise .note-front-label { color: var(--amber); }
.note-card.surprise .note-label { color: var(--amber); }
.note-card.surprise .note-text { color: var(--amber-bright); font-weight: 400; }
.note-card.surprise .note-number { color: var(--amber-dim); }

/* ── DONE SCREEN ── */
.done-screen {
  display: none;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100dvh;
  padding: 2rem;
  text-align: center;
  position: relative;
  z-index: 2;
}

.done-screen.active {
  display: flex;
}

.done-screen h2 {
  font-family: 'Inter', sans-serif;
  font-size: clamp(1.5rem, 6vw, 2.2rem);
  font-weight: 300;
  color: var(--text);
  opacity: 0;
  animation: fadeIn 0.8s ease 0.3s forwards;
  letter-spacing: -0.5px;
}

.done-screen p {
  font-size: 0.95rem;
  color: var(--text-dim);
  line-height: 1.7;
  max-width: 380px;
  font-weight: 300;
  opacity: 0;
  animation: fadeIn 0.8s ease 0.6s forwards;
  margin-top: 0.8rem;
}

.done-screen .love-forever {
  font-family: 'Inter', sans-serif;
  font-size: 1.2rem;
  font-weight: 400;
  color: var(--amber);
  opacity: 0;
  animation: fadeIn 0.8s ease 1s forwards;
  margin-top: 1rem;
}

.restart-btn {
  opacity: 0;
  animation: fadeIn 0.6s ease 1.4s forwards;
  margin-top: 2rem;
  padding: 0.65rem 1.8rem;
  border: 1px solid var(--border-light);
  background: var(--surface);
  color: var(--text-dim);
  font-family: 'JetBrains Mono', monospace;
  font-size: 0.75rem;
  font-weight: 400;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.3s ease;
}

.restart-btn:hover {
  border-color: var(--amber-dim);
  color: var(--amber);
  box-shadow: 0 0 20px var(--amber-glow);
}

/* ── SPARKLE BURST ── */
.sparkle {
  position: fixed;
  pointer-events: none;
  z-index: 150;
  border-radius: 50%;
  animation: sparkleBurst 0.8s ease-out forwards;
}

@keyframes sparkleBurst {
  0% { opacity: 0.8; transform: translate(0,0) scale(1); }
  100% { opacity: 0; transform: translate(var(--tx), var(--ty)) scale(0); }
}
</style>
</head>
<body>

<div class="grid-bg"></div>
<div class="glow-bg"></div>
<div class="hearts-container" id="heartsContainer"></div>

<!-- INTRO -->
<div class="intro-screen" id="introScreen">
  <p class="intro-tag">// valentine's day 2026</p>
  <h1 class="intro-title">Happy Valentine's Day, <span>Babe</span></h1>
  <p class="intro-subtitle">i made you something</p>
  <button class="intro-enter-btn" id="enterBtn">open(gift)<span class="blink">_</span></button>
</div>

<!-- JAR SCREEN -->
<div class="jar-screen" id="jarScreen">
  <div class="jar-header">
    <h2>// why i love you</h2>
  </div>

  <div class="jar-wrapper" id="jarWrapper">
    <div class="jar">
      <div class="jar-lid"></div>
      <div class="jar-body">
        <div class="jar-notes" id="jarNotes"></div>
      </div>
      <div class="jar-glow"></div>
    </div>
  </div>

  <p class="tap-hint" id="tapHint">click to pull a note<span class="blink">_</span></p>
</div>

<!-- NOTE OVERLAY -->
<div class="note-overlay" id="noteOverlay">
  <div class="note-card" id="noteCard">
    <div class="note-card-inner" id="noteCardInner">
      <div class="note-front" id="noteFront">
        <p class="note-front-label" id="noteFrontLabel">// reason</p>
        <p class="note-front-number" id="noteFrontNumber">#1</p>
        <p class="note-front-hint">tap to flip<span class="blink">_</span></p>
      </div>
      <div class="note-back">
        <button class="note-close-x" id="noteCloseBtn" aria-label="Close">
          <svg viewBox="0 0 14 14" fill="none"><line x1="1" y1="1" x2="13" y2="13"/><line x1="13" y1="1" x2="1" y2="13"/></svg>
        </button>
        <p class="note-label" id="noteLabel">// reason</p>
        <div class="note-text" id="noteText"></div>
        <p class="note-number" id="noteNumber"></p>
      </div>
    </div>
  </div>
</div>

<!-- DONE -->
<div class="done-screen" id="doneScreen">
  <h2>...and a million more reasons</h2>
  <p>Every one of those is true. And there are so many more I couldn't fit in the jar.</p>
  <p class="love-forever">I love you endlessly.</p>
  <button class="restart-btn" id="restartBtn">restart()<span class="blink">_</span></button>
</div>

<script>
var notes = [
  "The way you laugh when you think no one's watching",
  "How you always know exactly what to say",
  "Your smile first thing in the morning",
  "The way you hold my hand a little tighter in crowds",
  "How passionate you are about the things you love",
  "Your patience when I'm being difficult",
  "The little notes you leave for me",
  "How you make even ordinary days feel special",
  "Your terrible jokes that somehow always make me laugh",
  "The way you look at me like I'm your whole world",
  "How safe I feel when I'm with you",
  "Your kindness to strangers",
  "The way you dance when you think no one is looking",
  "How you never give up on us",
  "Your voice when you say my name",
  "The way you play with my hair",
  "How you always save the last bite for me",
  "Your hugs that make everything better",
  "The way you believe in me even when I don't",
  "How you remember the little things I tell you",
  "Your courage to be vulnerable with me",
  "The way you light up every room you walk into",
  "How you make me want to be a better person",
  "Your late night conversations that go on forever",
  "The way you scrunch your nose when you're happy",
  "How you always know when I need a hug",
  "Your contagious excitement about the little things",
  "The way you fit perfectly in my arms",
  "How you make my heart race even after all this time",
  "Your beautiful soul inside and out",
  "The way every love song reminds me of you",
  "How you turned my whole world into something beautiful",
  "And the biggest reason of all... because you chose me. And I'd choose you in every lifetime. Forever yours."
];

var noteColors = [
  '#FF6B6B', '#FFA94D', '#FFD43B', '#69DB7C',
  '#4ECDC4', '#74C0FC', '#DA77F2', '#FF8787'
];

var currentIndex = 0;
var shuffledNotes = [];
var surpriseNote = '';

// Audio — clean click + warm tone
var audioCtx = null;
function playChime() {
  try {
    if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    var t = audioCtx.currentTime;
    var o = audioCtx.createOscillator();
    var g = audioCtx.createGain();
    o.connect(g); g.connect(audioCtx.destination);
    o.type = 'triangle';
    o.frequency.setValueAtTime(660, t);
    o.frequency.exponentialRampToValueAtTime(880, t + 0.05);
    o.frequency.exponentialRampToValueAtTime(660, t + 0.15);
    g.gain.setValueAtTime(0.08, t);
    g.gain.exponentialRampToValueAtTime(0.001, t + 0.4);
    o.start(t); o.stop(t + 0.4);
  } catch(e) {}
}

// Subtle floating hearts — code-style
var heartSymbols = ['<3', '\u2665', '\u2764', '<3'];
function spawnHeart() {
  var h = document.createElement('div');
  h.className = 'floating-heart';
  h.textContent = heartSymbols[Math.floor(Math.random() * heartSymbols.length)];
  h.style.left = (5 + Math.random() * 90) + '%';
  h.style.fontSize = (10 + Math.random() * 8) + 'px';
  var dur = 14 + Math.random() * 10;
  h.style.animationDuration = dur + 's';
  document.getElementById('heartsContainer').appendChild(h);
  setTimeout(function() { h.remove(); }, dur * 1000 + 500);
}
setInterval(spawnHeart, 2500);
setTimeout(spawnHeart, 500);
setTimeout(spawnHeart, 1500);

// Sparkle burst
function burstSparkles(x, y) {
  for (var i = 0; i < 10; i++) {
    var s = document.createElement('div');
    s.className = 'sparkle';
    var angle = (Math.PI * 2 / 10) * i + (Math.random() * 0.3);
    var dist = 30 + Math.random() * 50;
    s.style.width = (2 + Math.random() * 3) + 'px';
    s.style.height = s.style.width;
    s.style.left = x + 'px';
    s.style.top = y + 'px';
    s.style.setProperty('--tx', Math.cos(angle) * dist + 'px');
    s.style.setProperty('--ty', Math.sin(angle) * dist + 'px');
    s.style.background = noteColors[Math.floor(Math.random() * noteColors.length)];
    document.body.appendChild(s);
    (function(el) { setTimeout(function() { el.remove(); }, 800); })(s);
  }
}

function init() {
  surpriseNote = notes[notes.length - 1];
  var regularNotes = notes.slice(0, -1);
  shuffledNotes = regularNotes.sort(function() { return Math.random() - 0.5; });
  shuffledNotes.push(surpriseNote);
  currentIndex = 0;

  var jarNotesEl = document.getElementById('jarNotes');
  while (jarNotesEl.firstChild) jarNotesEl.removeChild(jarNotesEl.firstChild);
  for (var i = 0; i < shuffledNotes.length; i++) {
    var mini = document.createElement('div');
    mini.className = 'jar-note-mini';
    mini.style.background = noteColors[i % noteColors.length];
    mini.style.setProperty('--rot', (Math.random() * 20 - 10) + 'deg');
    jarNotesEl.appendChild(mini);
  }
}

// INTRO -> JAR
document.getElementById('enterBtn').addEventListener('click', function() {
  playChime();
  document.getElementById('introScreen').classList.add('hidden');
  setTimeout(function() {
    document.getElementById('jarScreen').classList.add('active');
  }, 600);
});

// JAR TAP — show card (unflipped)
document.getElementById('jarWrapper').addEventListener('click', function(e) {
  if (currentIndex >= shuffledNotes.length) return;

  playChime();
  burstSparkles(e.clientX, e.clientY);

  var wrapper = document.getElementById('jarWrapper');
  wrapper.classList.remove('wobble');
  void wrapper.offsetWidth;
  wrapper.classList.add('wobble');

  var isSurprise = currentIndex === shuffledNotes.length - 1;
  var noteTextContent = shuffledNotes[currentIndex];

  var minis = document.querySelectorAll('.jar-note-mini:not(.removed)');
  if (minis.length > 0) minis[minis.length - 1].classList.add('removed');

  var card = document.getElementById('noteCard');
  // Reset flip state
  card.classList.remove('flipped');

  // Set front content
  document.getElementById('noteFrontNumber').textContent = '#' + (currentIndex + 1);
  if (isSurprise) {
    card.classList.add('surprise');
    document.getElementById('noteFrontLabel').textContent = '// the biggest reason';
    document.getElementById('noteLabel').textContent = '// the biggest reason';
  } else {
    card.classList.remove('surprise');
    document.getElementById('noteFrontLabel').textContent = '// reason';
    document.getElementById('noteLabel').textContent = '// reason #' + (currentIndex + 1);
  }

  // Set back content
  document.getElementById('noteText').textContent = noteTextContent;
  document.getElementById('noteNumber').textContent = '[' + (currentIndex + 1) + '/' + shuffledNotes.length + ']';

  document.getElementById('noteOverlay').classList.add('active');

  // Auto-flip after a brief moment
  setTimeout(function() {
    document.getElementById('noteCard').classList.add('flipped');
  }, 400);

  currentIndex++;

  document.getElementById('tapHint').style.display = 'none';
});

// CLOSE NOTE — unflip then dismiss
function closeNote() {
  var card = document.getElementById('noteCard');
  card.classList.remove('flipped');
  setTimeout(function() {
    document.getElementById('noteOverlay').classList.remove('active');
    if (currentIndex >= shuffledNotes.length) {
      setTimeout(function() {
        document.getElementById('jarScreen').classList.remove('active');
        document.getElementById('doneScreen').classList.add('active');
      }, 500);
    }
  }, 350);
}

document.getElementById('noteCloseBtn').addEventListener('click', closeNote);
document.getElementById('noteOverlay').addEventListener('click', function(e) {
  if (e.target === document.getElementById('noteOverlay')) closeNote();
});

// RESTART
document.getElementById('restartBtn').addEventListener('click', function() {
  document.getElementById('doneScreen').classList.remove('active');
  init();
  document.getElementById('tapHint').style.display = '';
  document.getElementById('jarScreen').classList.add('active');
});

init();
</script>
</body>
</html>
